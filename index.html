<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¨ëˆ„ë¦¬ìƒí’ˆê¶Œ & ê´‘ì£¼ìƒìƒì¹´ë“œ ê°€ë§¹ì  ì§€ë„</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ì „ì—­ ë³€ìˆ˜ì™€ í•¸ë“¤ëŸ¬ë¥¼ ë¨¼ì € ì •ì˜
        let useKakaoMap = false;
        let kakaoLoadAttempted = false;
        
        function handleKakaoLoadSuccess() {
            console.log('ì¹´ì¹´ì˜¤ ë§µ API ë¡œë“œ ì„±ê³µ');
            useKakaoMap = true;
            kakaoLoadAttempted = true;
            
            // APIê°€ ì™„ì „íˆ ë¡œë“œë  ë•Œê¹Œì§€ ì¶”ê°€ ëŒ€ê¸°
            setTimeout(() => {
                if (typeof kakao !== 'undefined' && kakao.maps && kakao.maps.LatLng) {
                    console.log('ì¹´ì¹´ì˜¤ ë§µ API ì™„ì „ ì´ˆê¸°í™” ì™„ë£Œ');
                } else {
                    console.log('ì¹´ì¹´ì˜¤ ë§µ API ì•„ì§ ì´ˆê¸°í™” ì¤‘...');
                }
            }, 500);
        }
        
        function handleKakaoLoadError() {
            console.log('ì¹´ì¹´ì˜¤ ë§µ API ë¡œë“œ ì‹¤íŒ¨');
            useKakaoMap = false;
            kakaoLoadAttempted = true;
        }
    </script>
    <!-- ì¹´ì¹´ì˜¤ë§µ API ì§ì ‘ ë¡œë“œ (ë¹„ë™ê¸° ë¬¸ì œ í•´ê²°) -->
    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=e2cdc03631e56cf5477a5fae91ffa305&autoload=false"></script>
    <script>
        // ì¹´ì¹´ì˜¤ë§µ SDK ìˆ˜ë™ ì´ˆê¸°í™”
        function initKakaoSDK() {
            if (window.kakao && window.kakao.maps) {
                console.log('âœ… ì¹´ì¹´ì˜¤ SDK ìˆ˜ë™ ì´ˆê¸°í™” ì‹œì‘');
                kakao.maps.load(() => {
                    console.log('âœ… ì¹´ì¹´ì˜¤ë§µ ì„œë¹„ìŠ¤ ë¡œë“œ ì™„ë£Œ');
                    handleKakaoLoadSuccess();
                });
            } else {
                console.log('âŒ ì¹´ì¹´ì˜¤ SDK ë¡œë“œ ì‹¤íŒ¨');
                handleKakaoLoadError();
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ SDK ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initKakaoSDK, 100);
        });
    </script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ì˜¨ëˆ„ë¦¬ìƒí’ˆê¶Œ & ê´‘ì£¼ìƒìƒì¹´ë“œ ê°€ë§¹ì  ì§€ë„</h1>
            <div id="map-status" style="text-align: center; color: rgba(255,255,255,0.8); font-size: 0.85rem; margin-bottom: 10px;"></div>
            <div class="controls">
                <div class="filter-group">
                    <label class="filter-label">
                        <input type="checkbox" id="onnuri-filter" checked>
                        <span class="checkmark onnuri"></span>
                        ì˜¨ëˆ„ë¦¬ìƒí’ˆê¶Œ ê°€ë§¹ì 
                    </label>
                    <label class="filter-label">
                        <input type="checkbox" id="gwangju-filter" checked>
                        <span class="checkmark gwangju"></span>
                        ê´‘ì£¼ìƒìƒì¹´ë“œ ê°€ë§¹ì 
                    </label>
                </div>
                <div class="search-group">
                    <input type="text" id="search-input" placeholder="ê°€ê²Œëª… ë˜ëŠ” ì£¼ì†Œë¡œ ê²€ìƒ‰">
                    <button id="search-btn">ê²€ìƒ‰</button>
                </div>
                <div class="location-group">
                    <button id="get-location-btn" class="location-btn">ğŸ“ ë‚´ ìœ„ì¹˜ ì°¾ê¸°</button>
                    <div class="location-info" id="location-info" style="display: none;">
                        <span id="location-status"></span>
                    </div>
                    <label class="filter-label location-filter">
                        <input type="checkbox" id="nearby-filter">
                        <span class="checkmark nearby"></span>
                        300m ì´ë‚´ë§Œ í‘œì‹œ
                    </label>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div id="map" class="map-container">
                <div id="loading-indicator" style="display: flex; justify-content: center; align-items: center; height: 100%; background-color: #f8f9fa; color: #666; font-size: 16px;">
                    <div style="text-align: center;">
                        <div style="width: 40px; height: 40px; border: 4px solid #e3e3e3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 15px;"></div>
                        <div>ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-label">ì˜¨ëˆ„ë¦¬ìƒí’ˆê¶Œ</span>
                        <span class="stat-count" id="onnuri-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ê´‘ì£¼ìƒìƒì¹´ë“œ</span>
                        <span class="stat-count" id="gwangju-count">0</span>
                    </div>
                </div>
                
                <div class="store-list">
                    <h3>ê°€ë§¹ì  ëª©ë¡</h3>
                    <div id="store-list-content">
                        <!-- ë§¤ì¥ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ë§¤ì¥ ì •ë³´ ëª¨ë‹¬ -->
    <div id="store-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-body">
                <!-- ë§¤ì¥ ìƒì„¸ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script src="real_stores.js"></script>
    <script src="script.js"></script>
</body>
</html>