<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카카오 맵 테스트</title>
    <style>
        #map {
            width: 100%;
            height: 400px;
            border: 2px solid #ccc;
            margin: 20px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #cce7ff; color: #004085; }
    </style>
</head>
<body>
    <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
        <h1>카카오 맵 API 테스트</h1>
        
        <div id="status" class="status info">테스트 시작 중...</div>
        
        <h2>현재 설정:</h2>
        <ul>
            <li><strong>도메인:</strong> <span id="current-domain"></span></li>
            <li><strong>API 키:</strong> 98ffa625d54db78b33ce72ff85c3db4a</li>
            <li><strong>프로토콜:</strong> <span id="protocol"></span></li>
        </ul>
        
        <h2>테스트 결과:</h2>
        <div id="test-results"></div>
        
        <div id="map"></div>
    </div>

    <script type="text/javascript" src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=98ffa625d54db78b33ce72ff85c3db4a"></script>
    <script>
        // 현재 환경 정보 표시
        document.getElementById('current-domain').textContent = window.location.host;
        document.getElementById('protocol').textContent = window.location.protocol;
        
        function addTestResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            document.getElementById('test-results').appendChild(div);
        }
        
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }
        
        // 테스트 시작
        setTimeout(function() {
            addTestResult('1단계: 스크립트 로드 확인 중...', 'info');
            
            if (typeof kakao === 'undefined') {
                addTestResult('❌ 실패: kakao 객체가 정의되지 않음', 'error');
                updateStatus('카카오 스크립트 로드 실패', 'error');
                
                // 가능한 원인 분석
                addTestResult('가능한 원인들:', 'info');
                addTestResult('- 도메인이 카카오 개발자센터에 등록되지 않음', 'error');
                addTestResult('- API 키가 잘못됨', 'error');
                addTestResult('- CORS 정책 위반', 'error');
                addTestResult('- HTTPS 인증서 문제', 'error');
                
                return;
            }
            
            addTestResult('✅ 성공: kakao 객체 로드됨', 'success');
            
            if (!kakao.maps) {
                addTestResult('❌ 실패: kakao.maps가 없음', 'error');
                updateStatus('카카오 맵 객체 없음', 'error');
                return;
            }
            
            addTestResult('✅ 성공: kakao.maps 객체 존재', 'success');
            
            try {
                // 지도 생성 시도
                addTestResult('2단계: 지도 생성 시도 중...', 'info');
                
                const container = document.getElementById('map');
                const options = {
                    center: new kakao.maps.LatLng(35.1595, 126.8526),
                    level: 3
                };
                
                const map = new kakao.maps.Map(container, options);
                
                addTestResult('✅ 성공: 카카오 맵 생성 완료!', 'success');
                updateStatus('카카오 맵 테스트 성공!', 'success');
                
                // 마커 추가 테스트
                addTestResult('3단계: 마커 추가 테스트...', 'info');
                const markerPosition = new kakao.maps.LatLng(35.1595, 126.8526);
                const marker = new kakao.maps.Marker({
                    position: markerPosition
                });
                marker.setMap(map);
                
                addTestResult('✅ 성공: 마커 추가 완료!', 'success');
                addTestResult('🎉 모든 테스트 통과! 카카오 맵이 정상 작동합니다.', 'success');
                
            } catch (error) {
                addTestResult('❌ 실패: 지도 생성 중 오류 - ' + error.message, 'error');
                updateStatus('지도 생성 실패: ' + error.message, 'error');
            }
            
        }, 2000);
    </script>
</body>
</html>